commit f1a83af1c53f5a5c841808349a52c9fb4795eebe:
(before refactoring)

* [16, 1, 1], batch 131072: 31.3147277832 ms, 1.33940298924 GFLOPS
* [1024, 1, 1], batch 2048: 107.768164063 ms, 0.972992357364 GFLOPS
* [8192, 1, 1], batch 256: 132.041113281 ms, 1.03236693945 GFLOPS
* [16, 16, 1], batch 8192: 46.2190093994 ms, 1.81496923214 GFLOPS
* [128, 128, 1], batch 128: 77.7142028809 ms, 1.88898083694 GFLOPS
* [1024, 1024, 1], batch 2: 191.239526367 ms, 1.09661012022 GFLOPS
* [16, 16, 16], batch 512: 59.5818115234 ms, 2.11187133762 GFLOPS
* [32, 32, 128], batch 16: 87.9920349121 ms, 2.02584154552 GFLOPS
* [128, 128, 128], batch 1: 107.403222656 ms, 2.05022674883 GFLOPS
